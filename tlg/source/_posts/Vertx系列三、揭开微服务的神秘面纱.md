title: Vertx系列三、揭开微服务的神秘面纱
author: 知识铺
date: 2020-04-13 19:56:24
tags:
---
## 揭开微服务的神秘面纱

除了你去年在一个山洞里度过，你可能听说过_微服务_。那么什么是_微服务_呢？要回答这个问题，让我们引用一位资深人士的话：

> 微服务体系结构样式是一种将单个应用程序开发为一组小型服务的方法，每个应用程序在自己的进程中运行，并与轻量级机制（通常是 HTTP 资源 API）通信。这些服务围绕业务功能构建，并通过全自动部署机制独立部署。这些服务的集中管理是最低限度的，这些服务可能用不同的编程语言编写，并使用不同的数据存储技术。

 • 马丁·福勒<cite>http://martinfowler.com/articles/microservices.html</cite>

_微服务_是一种_体系结构样式_，这意味着它是_元素和关系类型的专门化，以及约束以及如何使用它们_ <sup class="footnote">[[4]](https://zshipu.com/t?url=http://escoffier.me/vertx-hol/#_footnotedef_4 "View footnote.")</sup>。我相信到现在为止，在开始之前，我已经让你比你更困惑了。

不用担心。让我们采取另一种方法。为什么我们需要_微服务_？用一个词：**敏捷**<sup class="footnote">[[5]。](https://zshipu.com/t?url=http://escoffier.me/vertx-hol/#_footnotedef_5 "View footnote.")</sup>让我们想象一下，我们有一个应用程序，相当大。作为一个大型应用程序，维护是一个噩梦，添加功能需要太多的时间，使用的技术是非常过时的（什么？Corba 不再酷了？），任何更改都需要通过 50 个步骤流程，并由 5 级管理层进行验证。显然，应用程序上有几个团队有不同的要求和议程。嗯，我们有一个_这样的怪物应用程序_。如何有效地开发和维护此应用程序？微服务是这个问题的一个答案。它的目的是减少_生产时间_。

为此，_微服务_体系结构样式建议：

1.  将应用程序拆分为一组提供定义的分离组件（使用已知接口或 API_定义的_表示）
```
services
```


2.  允许组件与选择的任何协议（通常 REST）通信，但不一定

3.  允许组件使用他们想要的任何语言和技术

4.  允许独立开发、发布和部署每个组件

5.  允许在自己的_管道_中_自动_部署

6.  允许将整个应用程序的业务流程减少到最低最 bar

在本实验中，我们不会处理点 5，但您应该知道 Vert.x 不会限制部署组件的方式。您可以采用任何技术最好的套件您的环境。无论是ssh，云，甚至软盘。

然而，第6点是有趣的，而且经常被误解。开发独立的软件片段在运行时神奇地交互是很酷的。是的，我_神奇地说，_但在科技方面，我们不相信魔法。要做到这一点，我们需要的是某种形式的服务_发现_在运行时。服务发现机制可以通过任意数量的适当方法实现其目标。这些范围从：对代码中的服务位置进行硬编码（这通常是一个坏主意）、使用 DNS 查找服务或一些更高级的技术。

拥有服务发现机制允许我们的系统组件彼此透明地交互，而不考虑位置或环境。它还允许我们通过循环 alogorithm 轻松地在组件之间实现负载平衡，从而使我们的系统更加容错（通过在发生故障时查找另一个服务提供商）。

尽管根据定义，微服务应用程序不需要分发，但在实践中通常存在。这附带了所有分布式应用程序优势和约束：共识计算 （FLP）、CAP 定理、一致性、监视和许多其他失败原因。因此，需要设计微服务应用程序，以适应早期实施阶段的失败。

在我们更进一步之前，我想提几点。_微服务_**并不**新鲜，概念也不为火箭科学。70年代和80年代的学术论文已经定义（使用不同的词）建筑风格非常接近这一点。还有一个非常重要的理解点是：微服务不是一颗银弹。（除非管理良好），否则它有能力增加应用程序的复杂性，因为它的分布式性质。最后，微服务体系结构无法解决您的所有问题。

在微服务方面，主要关心的是快速交付、适应、独立和可替换性。每个微服务都由另一个提供相同_服务/API / 接口_（在核心，它基本上是[利斯科夫替代原则](https://zshipu.com/t?url=https://en.wikipedia.org/wiki/Liskov_substitution_principle)的应用）来替代。

如果您已经是开发人员大约 10 年，您可能需要询问微服务和SOA之间的区别。对很多人来说，它的大小。这并不总是正确的，因为服务不一定很小，这使得"微服务"一词相当具有误导性。微服务和SOA的目的不同，但基本概念相似：

*   服务：由 API、客户端、代理、任何内容访问的已定义功能

*   服务提供者：实现服务的组件

*   服务使用者：使用服务的组件

*   服务发现：使用者用于查找提供程序的机制

这两种方法都继承了_面向服务的计算_，旨在分解和管理独立的软件片段。即使您使用它，您可能从未听说过这一点：COM、Corba、Jini、OSGi 和 Web 服务都是_面向服务计算_的不同实现。

最后，有一种常见的误解，即微服务的性质必须是RESTful的。这不可能离事实更遥远。微服务可以使用任何最适合其用途的数字交互样式：RPC、事件、消息、流等。在本实验中，我们将使用 RESTful 服务、异步 RPC 和消息源。
