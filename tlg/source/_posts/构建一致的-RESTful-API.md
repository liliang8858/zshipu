title: 构建一致的 RESTful API
author: 知识铺
date: 2020-04-14 22:06:08
tags:
---
     在构建 RESTful API 时，应用程序是无限的，而标准和/或最佳实践在不同的堆栈中保持不变。这是试图描绘一些这些标准和最佳做法（高度意见）。

### 授权
	表示状态传输 （REST） 有效地使会话无效，因此，我们的应用程序需要另一种方式授权尝试访问它的用户。最常用的授权工具之一是JSON Web令牌-JWT。用户登录或注册我们的应用程序后，将令牌分配给该用户一段时间（长度主要取决于应用程序的安全问题）。一种好的做法是向令牌添加唯一标识符，以便应用程序中的每个请求都可以为发出该请求的特定用户提供服务，而无需向用户请求额外的参数。

例如，如果我使用 JWT 登录，并且尝试检索我在应用程序上进行的所有事务，则应用程序应该能够仅基于我的 JWT 授权令牌提供我的事务。

无需进入实现详细信息，则可以通过让服务拦截传入请求、处理 JWT 令牌并设置在整个应用程序中可访问的current_user对象或变量来实现此目的。

### 资源、操作和 HTTP 方法
	在 REST 中，我们有资源，可以表示数据库表，例如公司、用户、帖子、消息等。每个资源都有一个可以对它执行的操作的列表。这些操作由对该资源的每个请求的 HTTP 方法确定。HTTP 方法也称为 HTTP VERBS，因为它们执行/确定操作。给定一个资源，下面的事务是一些最常见的对应的 HTTP 方法和操作。
```
GET - /事务（获取所有交易）   
GET - /事务/：id（获取单个事务）   
POST -/事务（创建新事务）    
PUT - /事务/：id（更新交易部分）   
update - /事务/：id（更新交易）   
delete - /事务/：id（删除交易）
```
根据应用程序的规模，您可能需要按自定义终结点扩展资源上可用的操作。自定义终结点可以影响整个资源（集合）或资源的成员。对于影响集合的操作，如下所示：
```
GET - /事务/用户（获取已进行交易的所有用户）    
GET - /事务/失败（获取所有失败的事务）
```
对于成员，假设我们有一个单独的但相关的资源事务详细信息：
```
GET - /事务/：id/详细信息（获取交易详细信息）    
POST -/事务/：id/详细信息（为事务创建详细信息）    
PUT -/事务/id/详细信息（更新交易记录的详细信息）。
```
### HTTP 响应状态  
根据执行的操作和操作的状态，从每个请求返回的响应和状态。POST请求绝不应返回 204（无内容），删除请求不应返回 201（已创建）。以下是基于其请求和状态的最常见响应。

#### 200 - 确定  
请求已完成。但是，如果请求的操作已成功完成，则不能出错，具体取决于操作，可能会有更合适的状态消息。

#### 201 - 已创建   
理想情况下，每当在创建的对象旁边创建新对象（主要是使用POST请求）时，都应返回该对象。返回创建的对象是个人首选项，因为它将立即授予对新创建的对象的访问权限。

#### 204 - 无内容   
在对象上完成DELETE后，可以而且应该返回。

#### 401 - 未经授权   
当用户尝试需要授权但请求不具有该授权的操作时，这是适当的。

#### 404 - 未找到   
极不可能，但如果用户请求不存在的资源，则 404 是需要响应的适当状态。尽管基于您的用例，但返回200 - 确定，空结果可能更合适。